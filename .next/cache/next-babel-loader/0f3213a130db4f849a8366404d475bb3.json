{"ast":null,"code":"import _Date$now from \"@babel/runtime-corejs2/core-js/date/now\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Page from \"../templates/Page\";\nimport Link from \"next/link\";\nimport Timer from \"../components/Timer\";\nimport MileCounter from \"../components/MileCounter\";\nimport { useState, useEffect, useRef } from 'react';\n\nconst getCoordinates = (arr, callback) => {\n  let response = null;\n  var options = {\n    enableHighAccuracy: true,\n    timeout: 1000,\n    maximumAge: 0\n  };\n\n  function success(pos) {\n    let crd = pos.coords;\n    response = {\n      lat: crd.latitude,\n      lng: crd.longitude,\n      utc: _Date$now()\n    };\n    callback([...arr, response]);\n    return;\n  }\n\n  function error(err) {\n    console.warn(`ERROR(${err.code}): ${err.message}`);\n  }\n\n  navigator.geolocation.getCurrentPosition(success, error, options);\n};\n\nconst StartStop = props => {\n  const {\n    isRunning,\n    toggle\n  } = props;\n  return isRunning ? __jsx(\"a\", {\n    onClick: () => toggle(false)\n  }, \"Pause\") : __jsx(\"a\", {\n    onClick: () => toggle(true)\n  }, \"Start\");\n};\n\nfunction useInterval(callback, delay) {\n  const savedCallback = useRef(); // Remember the latest callback.\n\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]); // Set up the interval.\n\n  useEffect(() => {\n    function tick() {\n      savedCallback.current();\n    }\n\n    if (delay !== null) {\n      let id = setInterval(tick, delay);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n\nconst startTime = _Date$now();\n\nconst Running = () => {\n  const {\n    0: coordinates,\n    1: setCoordinates\n  } = useState([]);\n  const {\n    0: isRunning,\n    1: setIsRunning\n  } = useState(true);\n  const {\n    0: duration,\n    1: setDuration\n  } = useState(0);\n  useInterval(() => {\n    if (isRunning) {\n      getCoordinates(coordinates, setCoordinates);\n      const currentTime = coordinates[coordinates.length - 1] && coordinates[coordinates.length - 1].utc;\n\n      if (currentTime) {\n        setDuration((currentTime - startTime) / 1000);\n      }\n\n      console.log(coordinates); //console.log(coordinates);\n    }\n  }, 1000);\n  return __jsx(Page, null, __jsx(\"h1\", null, \"Run!\"), __jsx(MileCounter, null), __jsx(Timer, {\n    time: duration\n  }), __jsx(StartStop, {\n    isRunning: isRunning,\n    toggle: setIsRunning\n  }), __jsx(Link, {\n    href: \"/finished\"\n  }, __jsx(\"a\", null, \"Stop\")));\n};\n\nexport default Running;","map":null,"metadata":{},"sourceType":"module"}